<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Per Cos ‚ù§Ô∏è</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins&display=swap" rel="stylesheet">
<style>
body {
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: linear-gradient(135deg, #ffe6f0, #ffd6e7);
  font-family:'Poppins',sans-serif;
  overflow:hidden;
}

canvas {
  position:fixed;
  top:0;
  left:0;
  pointer-events:none;
  z-index:1;
}

.envelope {
  position:absolute;
  width:100%;
  height:100%;
  background:#ff4d6d;
  display:flex;
  justify-content:center;
  align-items:center;
  color:white;
  font-size:32px;
  font-family:'Playfair Display', serif;
  cursor:pointer;
  z-index:10;
  transition: transform 1s ease;
}

.envelope.open { transform:translateY(-100%); }

.container {
  background:white;
  padding:40px;
  border-radius:25px;
  box-shadow:0 20px 40px rgba(0,0,0,0.15);
  text-align:center;
  width:90%;
  max-width:400px;
  opacity:0;
  transform:scale(0.8);
  transition:all 0.8s ease;
  position:relative;
  z-index:2;
}

.container.show { opacity:1; transform:scale(1); }

h1 {
  font-family:'Playfair Display', serif;
  color:#d63384;
  font-size:26px;
}

.buttons {
  margin-top:30px;
  display:flex;
  justify-content:center;
  gap:10px;
  position:relative;
  min-height:50px;
}

button {
  padding:12px 25px;
  font-size:18px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  transition: transform 0.2s ease;
  transform-origin:center center;
}

#yesBtn { background:#28a745; color:white; }
#noBtn { 
  background:#dc3545; 
  display:none; /* nascosto all'inizio */
}

#personalMessage {
  margin-top:15px;
  font-size:20px;
  color:#d63384;
  opacity:0; /* invisibile inizialmente */
  font-family:'Playfair Display', serif;
  font-weight:600;
  transition: opacity 1s ease;
}

#gif {
  display:none;
  width:200px;
  margin-top:20px;
  border-radius:12px;
}
</style>
</head>
<body>

<canvas id="fireworks"></canvas>

<div class="envelope" id="envelope">üíå Per Cos</div>

<div class="container" id="card">
  <h1>Cos, vuoi essere la mia Valentina? (qualsiasi cosa signfichi)              ‚ú®‚ú®‚ú®‚ú®Ô∏è</h1>
  <div class="buttons" id="buttons">
    <button id="yesBtn">S√¨!</button>
    <div id="personalMessage"></div>
    <img id="gif" src="tuagif.gif">
  </div>
</div>

<button id="noBtn">No</button>

<audio id="music" loop>
  <source src="tuaMusica.mp3" type="audio/mpeg">
</audio>

<script>
const envelope = document.getElementById("envelope");
const card = document.getElementById("card");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const music = document.getElementById("music");
const personalMessage = document.getElementById("personalMessage");
const gif = document.getElementById("gif");

let yesScale = 1;

// Collisione tra rettangoli
function overlapRect(r1, r2) {
  return !(r1.right<r2.left || r1.left>r2.right || r1.bottom<r2.top || r1.top>r2.bottom);
}

// Apertura card e avvio musica
envelope.onclick = () => {
  envelope.classList.add("open");
  card.classList.add("show");

  // Avvia musica
  music.play().catch(()=>console.log("Musica non riprodotta"));

  // Mostra il tasto NO accanto a S√å
  const yesRect = yesBtn.getBoundingClientRect();
  noBtn.style.display = "block";
  noBtn.style.position = "fixed";
  noBtn.style.zIndex = 20;
  noBtn.style.left = (yesRect.right + 10) + "px";
  noBtn.style.top = yesRect.top + "px";
};

// Movimento NO
function moveNoButton() {
  const btnW = noBtn.offsetWidth;
  const btnH = noBtn.offsetHeight;
  const screenW = window.innerWidth;
  const screenH = window.innerHeight;
  const yesRect = yesBtn.getBoundingClientRect();

  let x, y, tries=0;
  do {
    x = Math.random()*(screenW-btnW);
    y = Math.random()*(screenH-btnH);
    const tempRect = {left:x, top:y, right:x+btnW, bottom:y+btnH};
    if(!overlapRect(tempRect, yesRect)) break;
    tries++;
  } while(tries<100);

  x = Math.min(Math.max(0, x), screenW-btnW);
  y = Math.min(Math.max(0, y), screenH-btnH);

  noBtn.style.left = x+"px";
  noBtn.style.top = y+"px";

  yesScale += 0.1;
  yesBtn.style.transform = `scale(${yesScale})`;
}

noBtn.addEventListener("mouseenter", moveNoButton);
noBtn.addEventListener("touchstart", moveNoButton);

// Click S√å -> fuochi + messaggio + GIF + nascondi pulsanti
yesBtn.onclick = ()=>{
  yesBtn.innerHTML="‚ù§Ô∏è";
  createFireworks();

  yesBtn.style.display = "none";
  noBtn.style.display = "none";

  personalMessage.textContent = "Sar√† meglio per te‚ù§Ô∏è";
  personalMessage.style.opacity = 0;
  setTimeout(()=>{ personalMessage.style.opacity = 1; }, 50);

  gif.style.display = "block"; // mostra la GIF
};

// Fuochi d‚Äôartificio
const canvas = document.getElementById("fireworks");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let particles=[];

function createFireworks(){
  for(let i=0;i<5;i++){
    setTimeout(()=>{
      const x=Math.random()*canvas.width;
      const y=Math.random()*canvas.height/2;
      for(let j=0;j<60;j++){
        particles.push({x,y,angle:Math.random()*2*Math.PI,speed:Math.random()*5+2,alpha:1,color:`hsl(${Math.random()*360},100%,60%)`});
      }
    },i*300);
  }
}

function animate(){
  ctx.fillStyle="rgba(0,0,0,0.1)";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  particles.forEach((p,i)=>{
    p.x+=Math.cos(p.angle)*p.speed;
    p.y+=Math.sin(p.angle)*p.speed;
    p.alpha-=0.02;
    ctx.beginPath();
    ctx.arc(p.x,p.y,3,0,Math.PI*2);
    ctx.fillStyle=`hsla(${Math.random()*360},100%,60%,${p.alpha})`;
    ctx.fill();
    if(p.alpha<=0) particles.splice(i,1);
  });

  requestAnimationFrame(animate);
}

animate();
</script>

</body>
</html>
